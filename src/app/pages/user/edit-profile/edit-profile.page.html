<ion-header no-border>
  <ion-toolbar no-border color="beauty">
    <ion-buttons slot="start">
      <ion-button (click)="dismiss()" color="light">
        <ion-icon slot="icon-only" name="arrow-round-back"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title>
      <strong>Edit Profil</strong>
    </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <div class="container">
    <input class="filebtn" type="file" (change)="onFileSelect($event)" #fileButton/>  
    <div class="ion-activatable" (click)="click()">
      <img *ngIf="!image" src="../../../assets/add-image.svg" />
      <img *ngIf="image" [src]="image" />
    </div>
    <form [formGroup]="form">
      <ion-item>
        <ion-label position="floating">
          <ion-icon class="icon" size="large" name="contact" color="beauty"></ion-icon>&nbsp;
          Nama Lengkap
        </ion-label>
        <ion-input autocapitalize="on" formControlName="nama" type="text"></ion-input>
      </ion-item>
      <ion-item>
        <ion-label position="floating">
          <ion-icon class="icon" size="large" name="logo-whatsapp" color="beauty"></ion-icon>&nbsp;
          Nomor Whatsapp
        </ion-label>
        <ion-input formControlName="hp" type="tel">
          <!-- <span *ngIf="prefix" matPrefix>+&nbsp;</span> -->
        </ion-input>
      </ion-item>
      <ion-item>
        <ion-label position="floating">
          <ion-icon class="icon" size="large" name="at" color="beauty"></ion-icon>&nbsp;
          Email
        </ion-label>
        <ion-input formControlName="email" type="email"></ion-input>
      </ion-item>
      <!-- <ion-item [color]="(form.controls['alamat'].pristine&&!form.controls['alamat'].value)?'tertiary':''">
        <ion-label position="stacked">Alamat Lengkap:</ion-label>
        <ion-textarea rows="2" placeholder="Lengkapi alamat nama jalan / no. rumah / desa / kelurahan / Rt.Rw"
          formControlName="alamat" type="text">
        </ion-textarea>
      </ion-item>
    <div *ngIf="!editKec">
      <ion-item>
        <ion-buttons slot="end">
          <ion-button (click)="editKec=true" fill="solid" color="beauty">
            <ion-icon name="create"></ion-icon>&nbsp;
            <ion-label color="light">Edit</ion-label>
          </ion-button>
        </ion-buttons>
        <ion-label position="fixed">
          Kecamatan:
        </ion-label>
        <ion-input [value]="form.controls['kec'].value" disabled type="text"></ion-input>
      </ion-item>
      <ion-item>
        <ion-label position="fixed">
          Kabupaten:
        </ion-label>
        <ion-input [value]="form.controls['kab'].value" disabled type="text"></ion-input>
      </ion-item>
      <ion-item>
        <ion-label position="fixed">
          Provinsi:
        </ion-label>
        <ion-input [value]="form.controls['prov'].value" disabled type="text"></ion-input>
      </ion-item>
    </div>
      <mat-accordion *ngIf="editKec">
        <mat-expansion-panel [expanded]="expand" (click)="form.controls['kec'].setValue(null)" style="margin-top:10px">
          <mat-expansion-panel-header>
            <mat-panel-title>
              <mat-icon>my_location</mat-icon>&nbsp;
              <span *ngIf="!kecPilihan">Kecamatan</span>
              <span *ngIf="kecPilihan"><strong>{{ kecPilihan.subdistrict_name }}</strong> {{ kecPilihan.city }}</span>
            </mat-panel-title>
          </mat-expansion-panel-header>
          <ion-input formControlName="kec" (click)="expand=!expand" (keyup)="cari(form.controls['kec'].value)" placeholder="Cari Kecamatan"></ion-input>

          <ion-list class="ion-no-padding">
              <ion-item *ngIf="dataKecamatan?.length===0 && form.controls['kec'].value?.length>1">
                <ion-label>
                  <span style="color:red">Kecamatan tidak ditemukan!</span>
                </ion-label>
              </ion-item>
              <ion-item *ngFor="let data of dataKecamatan" (click)="pilihKecamatan(data)">
                <ion-label>
                  <strong>{{ data?.subdistrict_name }}</strong>, {{ data?.city }}, {{ data?.province }}
                </ion-label>
              </ion-item>
          </ion-list>
        </mat-expansion-panel>
      </mat-accordion> -->
    </form>

    <br>

    <ion-button [disabled]="onupdate || form.invalid"
      expand="full" color="beauty" (click)="update()">UPDATE PROFIL
    </ion-button>
    <ion-progress-bar *ngIf="onupdate" type="indeterminate"></ion-progress-bar>
    <ion-button *ngIf="!onupdate" expand="full" fill="clear" color="beauty" (click)="dismiss()">BATAL</ion-button>
  </div>
</ion-content>
