<ion-header>
  <ion-toolbar color="primary" mode="ios">
    <ion-title>Transaksi</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="openCart()">
        <ion-icon slot="icon-only" color="light" name="cart"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
  <ion-toolbar mode="ios" class="fancy-toolbar ion-no-padding">
    <ion-segment color="primary" scrollable>
        <ion-segment-button (click)="filter('order')" checked layout="icon-start">
          <ion-label>Tagihan</ion-label>
          <ion-icon name="wallet"></ion-icon>
        </ion-segment-button>
        <ion-segment-button (click)="filter('dibayar')" layout="icon-start">
          <ion-label>Dibayar</ion-label>
          <ion-icon name="checkbox-outline"></ion-icon>
        </ion-segment-button>
        <ion-segment-button (click)="filter('dikirim')" layout="icon-start">
          <ion-label>Dikirim</ion-label>
          <ion-icon name="airplane"></ion-icon>
        </ion-segment-button>
    </ion-segment>
  </ion-toolbar>
  <ion-progress-bar *ngIf="onLoad" color="primary" type="indeterminate"></ion-progress-bar>
</ion-header>

<ion-content *ngIf="keeps">
    <ion-card [class]="keep.status" *ngFor="let keep of keeps">
      <ion-grid class="ion-no-padding">
        <ion-row>
          <ion-col size="1" style="padding:0 5px">
            <ion-label class="day">{{ keep.waktuOrder*1000 | date:'d' }}</ion-label>
            <ion-label class="month">{{ keep.waktuOrder*1000 | date:'MMM' }}</ion-label>
          </ion-col>
          <ion-col size="11" style="padding:0 5px">
            <ion-card-header (click)="keep.expand = !keep.expand"  style="padding: 10px">
              <ion-card-subtitle>
                <ion-label color="warning">ID#</ion-label>{{ keep.id }}&nbsp;
              </ion-card-subtitle>
              <ion-card-title class="ion-no-margin"><strong>{{ keep.penerima.nama | uppercase }}</strong></ion-card-title>
            </ion-card-header>
            <ion-label class="total"><strong>Rp{{ keep.total | number }}</strong></ion-label>
            <ion-label *ngIf="keep.status==='order'" class="jumlah-barang" color="primary">Lihat rincian</ion-label>
            <span *ngIf="keep.status==='dibayar'">
              <ion-label class="jumlah-barang" *ngIf="!keep?.dicek" color="medium"><ion-icon slot="icon-only" name="time"></ion-icon>&nbsp;VERIFIKASI</ion-label>
              <ion-label class="jumlah-barang" *ngIf="keep?.dicek" color="success"><ion-icon slot="icon-only" name="checkbox"></ion-icon>&nbsp;VALID</ion-label>    
            </span>
            <span *ngIf="keep.status==='dikirim'">
              <ion-label class="jumlah-barang" *ngIf="!keep?.resi" color="medium"><ion-icon slot="icon-only" name="jet"></ion-icon>&nbsp;DIKIRIM</ion-label>
              <ion-label class="jumlah-barang" *ngIf="keep?.resi" color="tertiary"><ion-icon slot="icon-only" name="barcode"></ion-icon>&nbsp;ADA RESI</ion-label>    
            </span>
          </ion-col>
        </ion-row>
      </ion-grid>
      <!-- <ion-card-content *ngIf="keep.expand" class="ion-no-padding">
        <ion-grid class="ion-no-padding" style="margin-top: -5px">
          <ion-row>
            <ion-col size="8">
            </ion-col>
            <ion-col size="4" class="ion-text-right">
              <ion-button (click)="copy(keep)" color="dark" fill="clear"><ion-icon slot="icon-only" name="copy"></ion-icon></ion-button>    
            </ion-col>
          </ion-row>
        </ion-grid>
      </ion-card-content> -->

      <ion-card-content *ngIf="keep.expand" class="ion-no-padding">
        <ion-list *ngFor="let barang of keep.pesanan" class="ion-no-padding">
          <ion-item button lines="full">
            <ion-ripple-effect></ion-ripple-effect>
            <ion-badge class="status" [color]="(barang.status==='diambil')?'success':(barang.status==='lost')?'danger':'dark'">{{barang.jumlah}}</ion-badge>
            <ion-label [color]="(barang.status==='diambil')?'success':(barang.status==='lost')?'danger':'dark'"><strong>{{barang.nama}}</strong></ion-label>
            <ion-label class="harga ion-text-right" slot="end">Rp{{barang.hargaJual * barang.jumlah | number}}</ion-label>
          </ion-item>
        </ion-list>
        <ion-list class="ion-no-padding">
          <ion-item lines="full">
            <ion-label>Ongkir <strong>{{keep.ekspedisi.kurir | uppercase}} {{keep.ekspedisi.service | uppercase}}</strong>:</ion-label>
            <ion-label class="harga ion-text-right" slot="end">Rp{{keep.ekspedisi.ongkir | number}}</ion-label>
          </ion-item>
          <ion-item lines="full">
            <ion-label>Kode Unik:</ion-label>
            <ion-label class="harga ion-text-right" slot="end">Rp{{keep.unik | number}}</ion-label>
          </ion-item>
          <ion-item lines="full">
            <ion-label>TOTAL TAGIHAN:</ion-label>
            <ion-label class="harga ion-text-right" color="primary" slot="end"><strong>Rp{{keep.total | number}}</strong></ion-label>
          </ion-item>
          <ion-item lines="full" *ngIf="keep.status==='dikirim' && keep?.resi">
            <ion-label color="tertiary">RESI:</ion-label>
            <ion-input color="tertiary" value="{{keep.resi}}"></ion-input>
          </ion-item>
        </ion-list>
      </ion-card-content>
      
      <ion-card-content *ngIf="keep.expand" class="ion-no-padding">
        <ion-grid class="ion-no-padding">
          <ion-row *ngIf="keep.status==='order'">
            <ion-col size="6" class="ion-no-padding">
              <section class="full-width">
                <ion-button (click)="cancel(keep)" color="danger" expand="full"><ion-icon slot="icon-only" name="close-circle"></ion-icon>&nbsp;Cancel Order</ion-button>
              </section>
            </ion-col>
            <ion-col size="6" class="ion-no-padding">
              <section class="full-width">
                <ion-button (click)="bayar(keep)" expand="full" color="primary"><ion-icon slot="icon-only" name="cash"></ion-icon>&nbsp;Bayar Tagihan</ion-button>
              </section>
            </ion-col>
          </ion-row>
        </ion-grid>
      </ion-card-content>

    </ion-card>
</ion-content>